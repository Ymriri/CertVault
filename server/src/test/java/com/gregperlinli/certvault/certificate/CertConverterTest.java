package com.gregperlinli.certvault.certificate;

import com.gregperlinli.certvault.domain.entities.CertPrivkeyResult;
import lombok.extern.slf4j.Slf4j;
import org.junit.jupiter.api.Test;
import org.springframework.boot.test.context.SpringBootTest;

import java.util.Base64;

/**
 * Certificate Converter Test
 *
 * @author gregPerlinLi
 * @version 1.0.0
 * @className {@code CertificateConverterTest}
 * @date 2025/4/14 23:54
 */
@SpringBootTest
@Slf4j
public class CertConverterTest {

    @Test
    public void testConvertFromPemToPfx() throws Exception {
        String certBase64 = "LS0tLS1CRUdJTiBDRVJUSUZJQ0FURS0tLS0tCk1JSUQ3akNDQXRhZ0F3SUJBZ0lSQUp3bS9RbmRUOXYzTWhDTmorejhGNk13RFFZSktvWklodmNOQVFFTEJRQXcKZ1oweEN6QUpCZ05WQkFZVEFrTk9NUkl3RUFZRFZRUUlEQWxIZFdGdVoyUnZibWN4RHpBTkJnTlZCQWNNQmtOaApiblJ2YmpFVk1CTUdBMVVFQ2d3TVIzSmxaMUJsY214cGJreHBNUkl3RUFZRFZRUUxEQWxEWlhKMFZtRjFiSFF4CkZUQVRCZ05WQkFNTURFTmxjblJXWVhWc2RDQkRRVEVuTUNVR0NTcUdTSWIzRFFFSkFSWVlaM0psWjFCbGNteHAKYmt4cFFHOTFkR3h2YjJzdVkyOXRNQjRYRFRJMU1EUXhOREUxTlRZd09Gb1hEVEk1TURVeU16RTFOVFl3T0ZvdwpnWjR4Q3pBSkJnTlZCQVlUQWtOT01SSXdFQVlEVlFRSURBbEhkV0Z1WjJSdmJtY3hEekFOQmdOVkJBY01Ca05oCmJuUnZiakVOTUFzR0ExVUVDZ3dFVkdWemRERVhNQlVHQTFVRUN3d09RMlZ5ZEZaaGRXeDBJRlJsYzNReEdUQVgKQmdOVkJBTU1FRU5sY25SV1lYVnNkQ0JKYm5RZ1EwRXhKekFsQmdrcWhraUc5dzBCQ1FFV0dHZHlaV2RRWlhKcwphVzVNYVVCdmRYUnNiMjlyTG1OdmJUQ0NBU0l3RFFZSktvWklodmNOQVFFQkJRQURnZ0VQQURDQ0FRb0NnZ0VCCkFMakgrM1VsdzQyWnBFTzNDTzRNZFl3SWRsdDBpaHJROWQ3V3dUV0xsZzZXekpiMzFycnV6WUhlRG9TenFpNXMKY3V2M0tYYk1ycm1WVmFkdlRqNHdkVnZCazdzRzRqS1NxZEl3bHpBck1CdlFyeXorS2Z3MXcxMm9wZ1lyenZDaApVZmJUR0I5U0k4Q2duWEZYc25La1piSmlTQUcvZ1o1RkdOdGFaT2VJdVBHZE51QXhZWXFjMEhGTjdUSW5aVVJmCk5ERmtCM0lvcHZGamxuT3pGdkFUd3YzMTh1VzF2N0lMUUN6eFF5dHJMOXl0VWJaUUNCVUhnei9DU3kzVzd6MlcKeHBTNjcrRU8wYWpiNHlueXpwd1JEem15SjJTVXNuN2dVS3Z4WnhDNzZYN2dNRlUvMTJjYXlnN1l3T2NJTHEyQgppeDgyZDl2dDhyc2hXM2ZTVzFNUGhuY0NBd0VBQWFNbU1DUXdEZ1lEVlIwUEFRSC9CQVFEQWdHR01CSUdBMVVkCkV3RUIvd1FJTUFZQkFmOENBUUF3RFFZSktvWklodmNOQVFFTEJRQURnZ0VCQUNuc1ZsdUtuRjNJMmdJc3NOajkKdTdzZWVGZC9aUlNJbmsvNnQvMUNPTnR0Ny9pZU5GWTZhVmorQVdIOC9LaFhoOHluTFhyYzhvNElwR2ovMzg5MwphVkxhQ0Z6NGtJeHVVampmelRzN0p2ZFlQM0oxczBNc3dGZ0FxR3pPSTRRR3lyNXZ0bHVLaGJacjhES08wU2EvCjZHdVVHMzhvYXpad3RCcWFhWTkybFg4UUFrRXJTMUV1QWhNclFXV0lqSkh4ZGhudmlGV01XeDcrTEIzTW5ram4Kb2NZSVhIb3F0WlNMbWl6T2FRRFZTQzZhdFFYMmpiQXUydU4wKzczNkJZOXlDeStqekhkYnU5RFlpdG56YVU5YgpieXpnd0NSdDF4Lzk0UWE4d3RYNVd1WXRGT1dyZWtCSk1tai8vR1oxVDZFSXErZStZU3NLQk9sajg1Vk9GTlA4CnJodz0KLS0tLS1FTkQgQ0VSVElGSUNBVEUtLS0tLQo=";
        String privkeyBase64 = "LS0tLS1CRUdJTiBQUklWQVRFIEtFWS0tLS0tCk1JSUV2d0lCQURBTkJna3Foa2lHOXcwQkFRRUZBQVNDQktrd2dnU2xBZ0VBQW9JQkFRQzR4L3QxSmNPTm1hUkQKdHdqdURIV01DSFpiZElvYTBQWGUxc0UxaTVZT2xzeVc5OWE2N3MyQjNnNkVzNm91YkhMcjl5bDJ6SzY1bFZXbgpiMDQrTUhWYndaTzdCdUl5a3FuU01KY3dLekFiMEs4cy9pbjhOY05kcUtZR0s4N3dvVkgyMHhnZlVpUEFvSjF4ClY3SnlwR1d5WWtnQnY0R2VSUmpiV21UbmlManhuVGJnTVdHS25OQnhUZTB5SjJWRVh6UXhaQWR5S0tieFk1WnoKc3hid0U4TDk5ZkxsdGIreUMwQXM4VU1yYXkvY3JWRzJVQWdWQjRNL3drc3QxdTg5bHNhVXV1L2hEdEdvMitNcAo4czZjRVE4NXNpZGtsTEorNEZDcjhXY1F1K2wrNERCVlA5ZG5Hc29PMk1EbkNDNnRnWXNmTm5mYjdmSzdJVnQzCjBsdFRENFozQWdNQkFBRUNnZ0VBRmxaaWtRcFVKZ0Y5U0l4UFlZdVRDQzhiczdtV1dtQ0pZSHRnbHVyOVpGMFoKZFdTWGlqaUZFbDU0TGRXVVRKRmlvU0RiVzllcGhaakdabnUvbnlmM2YvU2FPY0UreGZOUjRTMXJrWENmRzdXeAovNFBvS211TFp2NlV0MmxEVm5hQjlJOFhPdTRRa1dBNU9ETHNTUXlUbUtsbDRBUTVGSnR3d2srZXBCaTBsc3gvCjZsbkdiRHFCRkYwdjBmTXgrM0RZcE1uWUE2TmFoQzZPQ2hlcG5FZlV0Y0s3SjA2UFN0MVh0Y3l5Z3dXTFlnSHAKWEZnb0VTVU92Qlk1RXZEWUpGbyt0dFgvRS9TYWthRG5tUGtEOHJUYVFtS29nOVgxN0JVcFJNYXh4RDN1ZlVDMwpYUTBLYXc1aDN6VFRyTE5vV2ZZdDlhUFlFUUZsRG9sUE1jT0tIc3BnVFFLQmdRRDdlKzVFdFZIMkxBWURFRmpaClpvOEVRakJ1T25BYmFGd3RJaEsvTXBjWWhJVm1CNi9UR1ZjS1ArR3hBU2dpMW1vVHZoVGxCNHczdUZpV3ViaWcKRVI3aGZKU29OK2dJM3FmaGYwQ0h3cUNRait5c21BSFdXQWRlK0lYeXpadW1sTG1vdlY2eWJLZnlkNkorekpmZApiMEFIWnJoWlB0YW1MQUtLSDE3UlVucjdJd0tCZ1FDOEdXdEUxaXJONWlTS3dYY0xlMzErMXFUZzB1eTFuekdDCkZRQWs4aWk3clpoRUNGQmk2Y0cvVlNUak12ZnRHUFpmcGREcEkxSTZwQWNJSjd1bnFCWGpKeWJ4ODdVOFRTc3gKbzdKc3VxOFI4RE5JVjY2YnlHVE12SjB1dWdQeW5GM01IdDdKWGlRSWNmTFhSb2IzbENpN3BPclVnakVSRXEvdAptZFJGbWQrV25RS0JnUUN1dVJzQkY2MGJTTmpnZGhJVThZRjU1dmE1RHRibTQrbnUzWmFDeW9aWjNYREZRNS93CkhkSHdhQlBKSTlHYjZyYUdndkVIY3VnRHFvdTZKTXpXUVM3Z1lPcnp1T3Y0aGFIRU5PSkRzSUJZRC9iU3IwWFAKZ3hlVDd6MDVSWXJZQU1yQkp0ak5SRnFuUm1GYWtaRU5vd2FzWGJ6RkhMaUxlVlpHV3FkSTdYSk9Xd0tCZ1FDYQorbUtNWTl6K3FtbGZQY21FMTJsdDBSSWwvd056SFVmZ1FzZE1xWXp3SFRhQWowMFVRajhWRXVVQ29TTHU0Z3RVCmdUMWdhVzY5ekJuVEdWR2U4SG1nSDhrUnZ0ZUxhSlYzSDhYSm1nTFd4ODZwQXoxbE16WUNEa0YvbDFuYlVnUmkKUXVrU2hwTXZ0aHI4VGlxejRBbXptVXkyYk5KYW04Z0IveVdMZHgxbWJRS0JnUUNzSlE0dEF1YVZqNWUzYzRDaApxOGFDaW84WjIybmFza2VOUTJaRDFMdEw5VnNWMEljNHd5dUpkVVgrc1U1eTBZTThrbHdsbmFONUtzZmdMeTA2CllnTHFxNEhHMVRuSi9rbWVCemZCWldoT0drZjRyaktuNlVSWW5lM0FOOTB1WnBXREVCdnhtdlNCTDQrTkxaTm8KNmhMZEhYWFJocllscXBFK2orRDExWHkrVWc9PQotLS0tLUVORCBQUklWQVRFIEtFWS0tLS0tCg==";

        String certPfx1 = CertConverter.convertFromPemToPfx(certBase64, privkeyBase64, "myPass");
        String certPfx2 = CertConverter.convertFromPemToPfx(certBase64, null, null);

        log.info("PFX Cert and Privkey with password: {}", certPfx1);
        log.info("PFX Cert without password: {}", certPfx2);
    }

    @Test
    public void testConvertFromPfxToPem() throws Exception {
        String pfxWithCertAndPrivkeyBase64 = "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";
        String pfxWithCertBase64 = "MIACAQMwgAYJKoZIhvcNAQcBoIAEggRAMIIEPDCCBDgGCSqGSIb3DQEHAaCCBCkEggQlMIIEITCCBB0GCyqGSIb3DQEMCgEDoIIECjCCBAYGCiqGSIb3DQEJFgGgggP2BIID8jCCA+4wggLWoAMCAQICEQCcJv0J3U/b9zIQjY/s/BejMA0GCSqGSIb3DQEBCwUAMIGdMQswCQYDVQQGEwJDTjESMBAGA1UECAwJR3Vhbmdkb25nMQ8wDQYDVQQHDAZDYW50b24xFTATBgNVBAoMDEdyZWdQZXJsaW5MaTESMBAGA1UECwwJQ2VydFZhdWx0MRUwEwYDVQQDDAxDZXJ0VmF1bHQgQ0ExJzAlBgkqhkiG9w0BCQEWGGdyZWdQZXJsaW5MaUBvdXRsb29rLmNvbTAeFw0yNTA0MTQxNTU2MDhaFw0yOTA1MjMxNTU2MDhaMIGeMQswCQYDVQQGEwJDTjESMBAGA1UECAwJR3Vhbmdkb25nMQ8wDQYDVQQHDAZDYW50b24xDTALBgNVBAoMBFRlc3QxFzAVBgNVBAsMDkNlcnRWYXVsdCBUZXN0MRkwFwYDVQQDDBBDZXJ0VmF1bHQgSW50IENBMScwJQYJKoZIhvcNAQkBFhhncmVnUGVybGluTGlAb3V0bG9vay5jb20wggEiMA0GCSqGSIb3DQEBAQUAA4IBDwAwggEKAoIBAQC4x/t1JcONmaRDtwjuDHWMCHZbdIoa0PXe1sE1i5YOlsyW99a67s2B3g6Es6oubHLr9yl2zK65lVWnb04+MHVbwZO7BuIykqnSMJcwKzAb0K8s/in8NcNdqKYGK87woVH20xgfUiPAoJ1xV7JypGWyYkgBv4GeRRjbWmTniLjxnTbgMWGKnNBxTe0yJ2VEXzQxZAdyKKbxY5ZzsxbwE8L99fLltb+yC0As8UMray/crVG2UAgVB4M/wkst1u89lsaUuu/hDtGo2+Mp8s6cEQ85sidklLJ+4FCr8WcQu+l+4DBVP9dnGsoO2MDnCC6tgYsfNnfb7fK7IVt30ltTD4Z3AgMBAAGjJjAkMA4GA1UdDwEB/wQEAwIBhjASBgNVHRMBAf8ECDAGAQH/AgEAMA0GCSqGSIb3DQEBCwUAA4IBAQAp7FZbipxdyNoCLLDY/bu7HnhXf2UUiJ5P+rf9Qjjbbe/4njRWOmlY/gFh/PyoV4fMpy163PKOCKRo/9/Pd2lS2ghc+JCMblI43807Oyb3WD9ydbNDLMBYAKhsziOEBsq+b7ZbioW2a/AyjtEmv+hrlBt/KGs2cLQammmPdpV/EAJBK0tRLgITK0FliIyR8XYZ74hVjFse/iwdzJ5I56HGCFx6KrWUi5oszmkA1UgumrUF9o2wLtrjdPu9+gWPcgsvo8x3W7vQ2IrZ82lPW28s4MAkbdcf/eEGvMLV+VrmLRTlq3pASTJo//xmdU+hCKvnvmErCgTpY/OVThTT/K4cMQAAAAAAMD0wITAJBgUrDgMCGgUABBRmB/AkuPoPch3bw6nkJ6/rBF8kDwQUjAW3smEdYBZqPmzhk6/GkuzrFrsCAgPoAAA=";

        CertPrivkeyResult pemWithCertAndPrivkey = CertConverter.convertFromPfxToPem(pfxWithCertAndPrivkeyBase64, "myPass");
        CertPrivkeyResult pemWithCert = CertConverter.convertFromPfxToPem(pfxWithCertBase64, null);

        log.info("pemWithCertAndPrivkey: \n{}\n{}",
                new String(Base64.getDecoder().decode(pemWithCertAndPrivkey.getCertBase64())),
                new String(Base64.getDecoder().decode(pemWithCertAndPrivkey.getPrivateKeyBase64())));

        log.info("pemWithCert: \n{}", new String(Base64.getDecoder().decode(pemWithCert.getCertBase64())));
    }

    @Test
    public void testConvertFromPemToDer() throws Exception {
        String certBase64 = "LS0tLS1CRUdJTiBDRVJUSUZJQ0FURS0tLS0tCk1JSUQ3akNDQXRhZ0F3SUJBZ0lSQUp3bS9RbmRUOXYzTWhDTmorejhGNk13RFFZSktvWklodmNOQVFFTEJRQXcKZ1oweEN6QUpCZ05WQkFZVEFrTk9NUkl3RUFZRFZRUUlEQWxIZFdGdVoyUnZibWN4RHpBTkJnTlZCQWNNQmtOaApiblJ2YmpFVk1CTUdBMVVFQ2d3TVIzSmxaMUJsY214cGJreHBNUkl3RUFZRFZRUUxEQWxEWlhKMFZtRjFiSFF4CkZUQVRCZ05WQkFNTURFTmxjblJXWVhWc2RDQkRRVEVuTUNVR0NTcUdTSWIzRFFFSkFSWVlaM0psWjFCbGNteHAKYmt4cFFHOTFkR3h2YjJzdVkyOXRNQjRYRFRJMU1EUXhOREUxTlRZd09Gb1hEVEk1TURVeU16RTFOVFl3T0ZvdwpnWjR4Q3pBSkJnTlZCQVlUQWtOT01SSXdFQVlEVlFRSURBbEhkV0Z1WjJSdmJtY3hEekFOQmdOVkJBY01Ca05oCmJuUnZiakVOTUFzR0ExVUVDZ3dFVkdWemRERVhNQlVHQTFVRUN3d09RMlZ5ZEZaaGRXeDBJRlJsYzNReEdUQVgKQmdOVkJBTU1FRU5sY25SV1lYVnNkQ0JKYm5RZ1EwRXhKekFsQmdrcWhraUc5dzBCQ1FFV0dHZHlaV2RRWlhKcwphVzVNYVVCdmRYUnNiMjlyTG1OdmJUQ0NBU0l3RFFZSktvWklodmNOQVFFQkJRQURnZ0VQQURDQ0FRb0NnZ0VCCkFMakgrM1VsdzQyWnBFTzNDTzRNZFl3SWRsdDBpaHJROWQ3V3dUV0xsZzZXekpiMzFycnV6WUhlRG9TenFpNXMKY3V2M0tYYk1ycm1WVmFkdlRqNHdkVnZCazdzRzRqS1NxZEl3bHpBck1CdlFyeXorS2Z3MXcxMm9wZ1lyenZDaApVZmJUR0I5U0k4Q2duWEZYc25La1piSmlTQUcvZ1o1RkdOdGFaT2VJdVBHZE51QXhZWXFjMEhGTjdUSW5aVVJmCk5ERmtCM0lvcHZGamxuT3pGdkFUd3YzMTh1VzF2N0lMUUN6eFF5dHJMOXl0VWJaUUNCVUhnei9DU3kzVzd6MlcKeHBTNjcrRU8wYWpiNHlueXpwd1JEem15SjJTVXNuN2dVS3Z4WnhDNzZYN2dNRlUvMTJjYXlnN1l3T2NJTHEyQgppeDgyZDl2dDhyc2hXM2ZTVzFNUGhuY0NBd0VBQWFNbU1DUXdEZ1lEVlIwUEFRSC9CQVFEQWdHR01CSUdBMVVkCkV3RUIvd1FJTUFZQkFmOENBUUF3RFFZSktvWklodmNOQVFFTEJRQURnZ0VCQUNuc1ZsdUtuRjNJMmdJc3NOajkKdTdzZWVGZC9aUlNJbmsvNnQvMUNPTnR0Ny9pZU5GWTZhVmorQVdIOC9LaFhoOHluTFhyYzhvNElwR2ovMzg5MwphVkxhQ0Z6NGtJeHVVampmelRzN0p2ZFlQM0oxczBNc3dGZ0FxR3pPSTRRR3lyNXZ0bHVLaGJacjhES08wU2EvCjZHdVVHMzhvYXpad3RCcWFhWTkybFg4UUFrRXJTMUV1QWhNclFXV0lqSkh4ZGhudmlGV01XeDcrTEIzTW5ram4Kb2NZSVhIb3F0WlNMbWl6T2FRRFZTQzZhdFFYMmpiQXUydU4wKzczNkJZOXlDeStqekhkYnU5RFlpdG56YVU5YgpieXpnd0NSdDF4Lzk0UWE4d3RYNVd1WXRGT1dyZWtCSk1tai8vR1oxVDZFSXErZStZU3NLQk9sajg1Vk9GTlA4CnJodz0KLS0tLS1FTkQgQ0VSVElGSUNBVEUtLS0tLQo=";
        String privkeyBase64 = "LS0tLS1CRUdJTiBQUklWQVRFIEtFWS0tLS0tCk1JSUV2d0lCQURBTkJna3Foa2lHOXcwQkFRRUZBQVNDQktrd2dnU2xBZ0VBQW9JQkFRQzR4L3QxSmNPTm1hUkQKdHdqdURIV01DSFpiZElvYTBQWGUxc0UxaTVZT2xzeVc5OWE2N3MyQjNnNkVzNm91YkhMcjl5bDJ6SzY1bFZXbgpiMDQrTUhWYndaTzdCdUl5a3FuU01KY3dLekFiMEs4cy9pbjhOY05kcUtZR0s4N3dvVkgyMHhnZlVpUEFvSjF4ClY3SnlwR1d5WWtnQnY0R2VSUmpiV21UbmlManhuVGJnTVdHS25OQnhUZTB5SjJWRVh6UXhaQWR5S0tieFk1WnoKc3hid0U4TDk5ZkxsdGIreUMwQXM4VU1yYXkvY3JWRzJVQWdWQjRNL3drc3QxdTg5bHNhVXV1L2hEdEdvMitNcAo4czZjRVE4NXNpZGtsTEorNEZDcjhXY1F1K2wrNERCVlA5ZG5Hc29PMk1EbkNDNnRnWXNmTm5mYjdmSzdJVnQzCjBsdFRENFozQWdNQkFBRUNnZ0VBRmxaaWtRcFVKZ0Y5U0l4UFlZdVRDQzhiczdtV1dtQ0pZSHRnbHVyOVpGMFoKZFdTWGlqaUZFbDU0TGRXVVRKRmlvU0RiVzllcGhaakdabnUvbnlmM2YvU2FPY0UreGZOUjRTMXJrWENmRzdXeAovNFBvS211TFp2NlV0MmxEVm5hQjlJOFhPdTRRa1dBNU9ETHNTUXlUbUtsbDRBUTVGSnR3d2srZXBCaTBsc3gvCjZsbkdiRHFCRkYwdjBmTXgrM0RZcE1uWUE2TmFoQzZPQ2hlcG5FZlV0Y0s3SjA2UFN0MVh0Y3l5Z3dXTFlnSHAKWEZnb0VTVU92Qlk1RXZEWUpGbyt0dFgvRS9TYWthRG5tUGtEOHJUYVFtS29nOVgxN0JVcFJNYXh4RDN1ZlVDMwpYUTBLYXc1aDN6VFRyTE5vV2ZZdDlhUFlFUUZsRG9sUE1jT0tIc3BnVFFLQmdRRDdlKzVFdFZIMkxBWURFRmpaClpvOEVRakJ1T25BYmFGd3RJaEsvTXBjWWhJVm1CNi9UR1ZjS1ArR3hBU2dpMW1vVHZoVGxCNHczdUZpV3ViaWcKRVI3aGZKU29OK2dJM3FmaGYwQ0h3cUNRait5c21BSFdXQWRlK0lYeXpadW1sTG1vdlY2eWJLZnlkNkorekpmZApiMEFIWnJoWlB0YW1MQUtLSDE3UlVucjdJd0tCZ1FDOEdXdEUxaXJONWlTS3dYY0xlMzErMXFUZzB1eTFuekdDCkZRQWs4aWk3clpoRUNGQmk2Y0cvVlNUak12ZnRHUFpmcGREcEkxSTZwQWNJSjd1bnFCWGpKeWJ4ODdVOFRTc3gKbzdKc3VxOFI4RE5JVjY2YnlHVE12SjB1dWdQeW5GM01IdDdKWGlRSWNmTFhSb2IzbENpN3BPclVnakVSRXEvdAptZFJGbWQrV25RS0JnUUN1dVJzQkY2MGJTTmpnZGhJVThZRjU1dmE1RHRibTQrbnUzWmFDeW9aWjNYREZRNS93CkhkSHdhQlBKSTlHYjZyYUdndkVIY3VnRHFvdTZKTXpXUVM3Z1lPcnp1T3Y0aGFIRU5PSkRzSUJZRC9iU3IwWFAKZ3hlVDd6MDVSWXJZQU1yQkp0ak5SRnFuUm1GYWtaRU5vd2FzWGJ6RkhMaUxlVlpHV3FkSTdYSk9Xd0tCZ1FDYQorbUtNWTl6K3FtbGZQY21FMTJsdDBSSWwvd056SFVmZ1FzZE1xWXp3SFRhQWowMFVRajhWRXVVQ29TTHU0Z3RVCmdUMWdhVzY5ekJuVEdWR2U4SG1nSDhrUnZ0ZUxhSlYzSDhYSm1nTFd4ODZwQXoxbE16WUNEa0YvbDFuYlVnUmkKUXVrU2hwTXZ0aHI4VGlxejRBbXptVXkyYk5KYW04Z0IveVdMZHgxbWJRS0JnUUNzSlE0dEF1YVZqNWUzYzRDaApxOGFDaW84WjIybmFza2VOUTJaRDFMdEw5VnNWMEljNHd5dUpkVVgrc1U1eTBZTThrbHdsbmFONUtzZmdMeTA2CllnTHFxNEhHMVRuSi9rbWVCemZCWldoT0drZjRyaktuNlVSWW5lM0FOOTB1WnBXREVCdnhtdlNCTDQrTkxaTm8KNmhMZEhYWFJocllscXBFK2orRDExWHkrVWc9PQotLS0tLUVORCBQUklWQVRFIEtFWS0tLS0tCg==";

        CertPrivkeyResult certPrivkeyResult = CertConverter.convertFromPemToDer(certBase64, privkeyBase64);

        log.info("DER Certificate: {}", certPrivkeyResult.getCertBase64());
        log.info("DER Private Key: {}", certPrivkeyResult.getPrivateKeyBase64());
    }

    @Test
    public void testConvertFromDerToPem() throws Exception {
        String certBase64 = "MIID7jCCAtagAwIBAgIRAJwm/QndT9v3MhCNj+z8F6MwDQYJKoZIhvcNAQELBQAwgZ0xCzAJBgNVBAYTAkNOMRIwEAYDVQQIDAlHdWFuZ2RvbmcxDzANBgNVBAcMBkNhbnRvbjEVMBMGA1UECgwMR3JlZ1BlcmxpbkxpMRIwEAYDVQQLDAlDZXJ0VmF1bHQxFTATBgNVBAMMDENlcnRWYXVsdCBDQTEnMCUGCSqGSIb3DQEJARYYZ3JlZ1BlcmxpbkxpQG91dGxvb2suY29tMB4XDTI1MDQxNDE1NTYwOFoXDTI5MDUyMzE1NTYwOFowgZ4xCzAJBgNVBAYTAkNOMRIwEAYDVQQIDAlHdWFuZ2RvbmcxDzANBgNVBAcMBkNhbnRvbjENMAsGA1UECgwEVGVzdDEXMBUGA1UECwwOQ2VydFZhdWx0IFRlc3QxGTAXBgNVBAMMEENlcnRWYXVsdCBJbnQgQ0ExJzAlBgkqhkiG9w0BCQEWGGdyZWdQZXJsaW5MaUBvdXRsb29rLmNvbTCCASIwDQYJKoZIhvcNAQEBBQADggEPADCCAQoCggEBALjH+3Ulw42ZpEO3CO4MdYwIdlt0ihrQ9d7WwTWLlg6WzJb31rruzYHeDoSzqi5scuv3KXbMrrmVVadvTj4wdVvBk7sG4jKSqdIwlzArMBvQryz+Kfw1w12opgYrzvChUfbTGB9SI8CgnXFXsnKkZbJiSAG/gZ5FGNtaZOeIuPGdNuAxYYqc0HFN7TInZURfNDFkB3IopvFjlnOzFvATwv318uW1v7ILQCzxQytrL9ytUbZQCBUHgz/CSy3W7z2WxpS67+EO0ajb4ynyzpwRDzmyJ2SUsn7gUKvxZxC76X7gMFU/12cayg7YwOcILq2Bix82d9vt8rshW3fSW1MPhncCAwEAAaMmMCQwDgYDVR0PAQH/BAQDAgGGMBIGA1UdEwEB/wQIMAYBAf8CAQAwDQYJKoZIhvcNAQELBQADggEBACnsVluKnF3I2gIssNj9u7seeFd/ZRSInk/6t/1CONtt7/ieNFY6aVj+AWH8/KhXh8ynLXrc8o4IpGj/3893aVLaCFz4kIxuUjjfzTs7JvdYP3J1s0MswFgAqGzOI4QGyr5vtluKhbZr8DKO0Sa/6GuUG38oazZwtBqaaY92lX8QAkErS1EuAhMrQWWIjJHxdhnviFWMWx7+LB3MnkjnocYIXHoqtZSLmizOaQDVSC6atQX2jbAu2uN0+736BY9yCy+jzHdbu9DYitnzaU9bbyzgwCRt1x/94Qa8wtX5WuYtFOWrekBJMmj//GZ1T6EIq+e+YSsKBOlj85VOFNP8rhw=";
        String certPrivkey64 = "MIIEvwIBADANBgkqhkiG9w0BAQEFAASCBKkwggSlAgEAAoIBAQC4x/t1JcONmaRDtwjuDHWMCHZbdIoa0PXe1sE1i5YOlsyW99a67s2B3g6Es6oubHLr9yl2zK65lVWnb04+MHVbwZO7BuIykqnSMJcwKzAb0K8s/in8NcNdqKYGK87woVH20xgfUiPAoJ1xV7JypGWyYkgBv4GeRRjbWmTniLjxnTbgMWGKnNBxTe0yJ2VEXzQxZAdyKKbxY5ZzsxbwE8L99fLltb+yC0As8UMray/crVG2UAgVB4M/wkst1u89lsaUuu/hDtGo2+Mp8s6cEQ85sidklLJ+4FCr8WcQu+l+4DBVP9dnGsoO2MDnCC6tgYsfNnfb7fK7IVt30ltTD4Z3AgMBAAECggEAFlZikQpUJgF9SIxPYYuTCC8bs7mWWmCJYHtglur9ZF0ZdWSXijiFEl54LdWUTJFioSDbW9ephZjGZnu/nyf3f/SaOcE+xfNR4S1rkXCfG7Wx/4PoKmuLZv6Ut2lDVnaB9I8XOu4QkWA5ODLsSQyTmKll4AQ5FJtwwk+epBi0lsx/6lnGbDqBFF0v0fMx+3DYpMnYA6NahC6OChepnEfUtcK7J06PSt1XtcyygwWLYgHpXFgoESUOvBY5EvDYJFo+ttX/E/SakaDnmPkD8rTaQmKog9X17BUpRMaxxD3ufUC3XQ0Kaw5h3zTTrLNoWfYt9aPYEQFlDolPMcOKHspgTQKBgQD7e+5EtVH2LAYDEFjZZo8EQjBuOnAbaFwtIhK/MpcYhIVmB6/TGVcKP+GxASgi1moTvhTlB4w3uFiWubigER7hfJSoN+gI3qfhf0CHwqCQj+ysmAHWWAde+IXyzZumlLmovV6ybKfyd6J+zJfdb0AHZrhZPtamLAKKH17RUnr7IwKBgQC8GWtE1irN5iSKwXcLe31+1qTg0uy1nzGCFQAk8ii7rZhECFBi6cG/VSTjMvftGPZfpdDpI1I6pAcIJ7unqBXjJybx87U8TSsxo7Jsuq8R8DNIV66byGTMvJ0uugPynF3MHt7JXiQIcfLXRob3lCi7pOrUgjEREq/tmdRFmd+WnQKBgQCuuRsBF60bSNjgdhIU8YF55va5Dtbm4+nu3ZaCyoZZ3XDFQ5/wHdHwaBPJI9Gb6raGgvEHcugDqou6JMzWQS7gYOrzuOv4haHENOJDsIBYD/bSr0XPgxeT7z05RYrYAMrBJtjNRFqnRmFakZENowasXbzFHLiLeVZGWqdI7XJOWwKBgQCa+mKMY9z+qmlfPcmE12lt0RIl/wNzHUfgQsdMqYzwHTaAj00UQj8VEuUCoSLu4gtUgT1gaW69zBnTGVGe8HmgH8kRvteLaJV3H8XJmgLWx86pAz1lMzYCDkF/l1nbUgRiQukShpMvthr8Tiqz4AmzmUy2bNJam8gB/yWLdx1mbQKBgQCsJQ4tAuaVj5e3c4Chq8aCio8Z22naskeNQ2ZD1LtL9VsV0Ic4wyuJdUX+sU5y0YM8klwlnaN5KsfgLy06YgLqq4HG1TnJ/kmeBzfBZWhOGkf4rjKn6URYne3AN90uZpWDEBvxmvSBL4+NLZNo6hLdHXXRhrYlqpE+j+D11Xy+Ug==";

        CertPrivkeyResult certPrivkeyResult = CertConverter.convertFromDerToPem(certBase64, certPrivkey64);

        log.info("PEM Certificate: \n{}", new String(Base64.getDecoder().decode(certPrivkeyResult.getCertBase64())));
        log.info("PEM Private Key: \n{}", new String(Base64.getDecoder().decode(certPrivkeyResult.getPrivateKeyBase64())));
    }

}
