package com.gregperlinli.certvault.certificate;

import com.gregperlinli.certvault.domain.entities.CertGenRequest;
import com.gregperlinli.certvault.domain.entities.CertRenewRequest;
import com.gregperlinli.certvault.domain.entities.GenResponse;
import com.gregperlinli.certvault.domain.entities.SubjectAltName;
import lombok.extern.slf4j.Slf4j;
import org.junit.jupiter.api.Test;
import org.springframework.boot.test.context.SpringBootTest;

import java.util.List;

/**
 * SSL Certificate Generator Test
 *
 * @author gregPerlinLi
 * @version 1.0.0
 * @className {@code SslCertGeneratorTest}
 * @date 2025/3/15 14:58
 */
@SpringBootTest
@Slf4j
public class SslCertGeneratorTest {

    @Test
    public void testGenerateSslCertificate() {
        CertGenRequest request = new CertGenRequest()
                .setCaKey("LS0tLS1CRUdJTiBQUklWQVRFIEtFWS0tLS0tCk1JSUV2UUlCQURBTkJna3Foa2lHOXcwQkFRRUZBQVNDQktjd2dnU2pBZ0VBQW9JQkFRQzNkbTFWZWQzUzQzRWgKTzVvWnBkK1lqaCtFMG9qaTR3QUJDR2pBOFBsOU90WUVkalBwcWdJNnJjR0tvdmtKb2xOdUxmTUZobGZnTEc2TgoxZXlwcE1hUlFuWC9ReUh5azNrZGpCMXdPakFXWlFsZi9BMHdnY2MxanhEbmJnK2s1OTZ2emZuYWQvUkdmYmgzCllYWGQ4ZmJldWk4VEw5UUxtdGhRS0ZZZ1dLckY0SWRuZ2xJUWwrWk9KMkd2TmxYN3p3Z2YxdUlTbkp5K0RnU2kKa0NlRWxabm9aeGloeGhHZGlWSVU1cVJ5Z05IVlptSkc1VENkTXhpWURwVEpaM2pMVHp4bHlxNnpQNTVQMUVZNQprMkRkQ3VFblBYcDVmRWVUSkM2bm5kRFprLzI0MVNneVZ1MzUwUVdxdWc3YkIxN0Q5LzI0NTZocWhqZmVaK0JWCnBLbGtaclVQQWdNQkFBRUNnZ0VBR2NaMkt1Mmh1Q2pETXFlVWlXandCcGRsSHp5VEJjbGRyVWQ0ckM3TzVvUzMKSDg1Wmtja1VZaGthV1hkM0pKN2RPTndVeWlCclJUQUk0ajE5Y0FJWjhidVVKMlpQcFN5SjloaEM1SXNRU1gwdAplWUpJZWhtcG1zRThYejlyekQvVlhmN0N6U3BRTS8waXh3YjJ6OVZZV1Vkd0tMSnVDS2xiSGJ2bENjdGJSc3g5ClpFOC9JOFVvMW9QZGpCOTdBNnQ2WlJQbXhSdWVqYUhiQzNWRHNKTTcrTkhKcXVjTm40dUZ2aDFHRUR4ZjZhMzIKdDh4N013OUx0dEM3QkUzYWFTR3ZTMjd1Q29aeWl3VXU2cFBCRHJOTHRZaHZ1a0ZmRlRkR2k3dzc4Sk9mR1c3aQpWdnVOMThHZVd0dUU4NGY1V2dHb1cyNStOaTNLNWdFZzZzZEVER0szOFFLQmdRRFl2SjdnRFc5UmtxMWNxcFJTCjFVZ1gyNTh6Wm8wYmZQbWg0cjkxSndzZVI3a1ppaDJETFphZlhrUzA0ZlhDSUE1NFd3Vkx2dVdiaVJLQWxxdGoKUUNvUXl0ODVwbzBVNmd5WWtQelVuSGF3eFpyaVRWajlJM0ZCcXVBRVpOeVRHcHp4SVhrOThHV2FnblZlU1BBKwowK1pVS1E0VkhZSFMxOVlSSDcxL2h5VTQ4UUtCZ1FEWXNxNzN3cDVUVWViQnpidjJoZ2cxY0pqeFl0dHowWE9RCjJqOW41ZjBFanRtM3VzbnlsUjMrY2pVNEw5ZzV3bkUzdkdGOFhqbnk4U09sMkc3TWIxTkJyWU9WbUVIS3ZJeFYKYmxsYzJVUHphY3FZcDFVQi9ma1VsRHdGZFV4enFxSmY5K3BVUTFKQTNuUW56ZUkzMWRtZzIySE81SWdqbFFGNApXdklxSTFyTi93S0JnRTlDMDVzK2JvcFhhTHp0eU9adUJ6cHFYOU10V3NkRnNna280am1XdUxNdktac1VibXlOCm5IclZ2Nnlpd2Z4bk9zTjdEZm5BYXpteExDb0liODhSSlJFVkVBT0dUQ3ZzMkFSbmFYN2JaWENLSTNWRk1oa0oKQUI4eXZVLytEc2hoUUNuU3d3TUt5aTF5TGpmMzFwd3paQlU5R21CUWRTekZNQXo5SFpEb3ZJMFJBb0dBWnkwTQpxZUw4UjJlam0zczlsNjlSa1VBL1VnOWp0YzF3WFBQTlpNYllwYWJ1ZXRCdy94T0k2SEd3YlVRNmk2WE5DbUNqCmVmZlRWNTBCQUNJQS8wMnlNbjlQTzViM0hIU1J6TXR4dVFlcGx1ZzBFbUw1MHF6K1A1SWswZVI3dGtiMGNRVTEKaVZGVWhKWm1iOTFUYklwaHlIa3NKTG9qSiszMmVUdTBPZVFEaERrQ2dZRUFwaVZucnBidTNZd2I3WGpBa2hKUQowZE9JejUwaGp4eUh3Mk1xcHBJWjljaHV2WTh4eWRObGFXRU9CbzAxZEFQOVFTa0VUazVWMFQ1ZWc4QlpRb1FECmpieUNXOGkvQis5VXBIME5YakpXL0c5WEZJMHhOdWJTeHhtTUlDZmk1Y1drTm9mK3VGc0FZajZ0RU5RWWdZL3kKZjgwMEhmb0JmbEpNZzcrV0dOSWsyVW89Ci0tLS0tRU5EIFBSSVZBVEUgS0VZLS0tLS0K")
                .setCa("LS0tLS1CRUdJTiBDRVJUSUZJQ0FURS0tLS0tCk1JSUQ1ekNDQXMrZ0F3SUJBZ0lSQUxPV1BPQTg0TDN2dFhIR1A5N0JCODB3RFFZSktvWklodmNOQVFFTEJRQXcKZ1pveEN6QUpCZ05WQkFZVEFrTk9NUkl3RUFZRFZRUUlEQWxIZFdGdVoyUnZibWN4RHpBTkJnTlZCQWNNQmtOaApiblJ2YmpFVk1CTUdBMVVFQ2d3TVIzSmxaMUJsY214cGJreHBNUkl3RUFZRFZRUUxEQWxEWlhKMFZtRjFiSFF4CkVqQVFCZ05WQkFNTUNVTmxjblJXWVhWc2RERW5NQ1VHQ1NxR1NJYjNEUUVKQVJZWVozSmxaMUJsY214cGJreHAKUUc5MWRHeHZiMnN1WTI5dE1CNFhEVEkxTURNeE5UQTFORE16TTFvWERUSTJNRE14TlRBMU5ETXpNMW93Z1pveApDekFKQmdOVkJBWVRBa05PTVJJd0VBWURWUVFJREFsSGRXRnVaMlJ2Ym1jeER6QU5CZ05WQkFjTUJrTmhiblJ2CmJqRVZNQk1HQTFVRUNnd01SM0psWjFCbGNteHBia3hwTVJJd0VBWURWUVFMREFsRFpYSjBWbUYxYkhReEVqQVEKQmdOVkJBTU1DVU5sY25SV1lYVnNkREVuTUNVR0NTcUdTSWIzRFFFSkFSWVlaM0psWjFCbGNteHBia3hwUUc5MQpkR3h2YjJzdVkyOXRNSUlCSWpBTkJna3Foa2lHOXcwQkFRRUZBQU9DQVE4QU1JSUJDZ0tDQVFFQXQzWnRWWG5kCjB1TnhJVHVhR2FYZm1JNGZoTktJNHVNQUFRaG93UEQ1ZlRyV0JIWXo2YW9DT3EzQmlxTDVDYUpUYmkzekJZWlgKNEN4dWpkWHNxYVRHa1VKMS8wTWg4cE41SFl3ZGNEb3dGbVVKWC93Tk1JSEhOWThRNTI0UHBPZmVyODM1Mm5mMApSbjI0ZDJGMTNmSDIzcm92RXkvVUM1cllVQ2hXSUZpcXhlQ0haNEpTRUpmbVRpZGhyelpWKzg4SUg5YmlFcHljCnZnNEVvcEFuaEpXWjZHY1lvY1lSbllsU0ZPYWtjb0RSMVdaaVJ1VXduVE1ZbUE2VXlXZDR5MDg4WmNxdXN6K2UKVDlSR09aTmczUXJoSnoxNmVYeEhreVF1cDUzUTJaUDl1TlVvTWxidCtkRUZxcm9PMndkZXcvZjl1T2VvYW9ZMwozbWZnVmFTcFpHYTFEd0lEQVFBQm95WXdKREFPQmdOVkhROEJBZjhFQkFNQ0FZWXdFZ1lEVlIwVEFRSC9CQWd3CkJnRUIvd0lCQURBTkJna3Foa2lHOXcwQkFRc0ZBQU9DQVFFQUtaU0ZpVkd1dTF0TjFFL0NveEdpWGVVSnludmIKNDNUejBrd0ZhYkczZ0M1QlhVTzdwc2g1aWVVODNkYllXck9IcE5qNW8ycFd6a0dpekU2VE5zZ2g2NFUxSUllQwpUSW9ubFBab2U5T2UvaWs1UjIxRjFTVkhQK0l6dmVGd1FnNXNWZTM2dzlWcm52cnZNcDU0NzVObDcxLzB3dE0vCit0d3hPKzFKMG5hUEd6cEVXelZyMmNMRi9taEFzREpacWZuU08wTVhscUpWSjhhTVZUTStVYWNiSWlQM2hMUXIKa0VRd3g4UW9mMTNOMVY4Ti9leWpUcHlPVzZqREVRWElnK09Iam1BeFBnZ3I1RG9DQksvM3lzZFltWGhJN3p0TwpGQy9zMi9FT1RsQmNzQS83NmhZNkcwUG1ZdnI1ZUxrekc2WklmT25sSFpmVDY5eEJlT08wNDNwdTVBPT0KLS0tLS1FTkQgQ0VSVElGSUNBVEUtLS0tLQo=")
                .setCountry("CN")
                .setProvince("Guangdong")
                .setCity("Canton")
                .setOrganization("GregPerlinLi")
                .setOrganizationalUnit("CertVault")
                .setCommonName("cv.gpl.ac.cn")
                .setEmailAddress("gregPerlinLi@outlook.com")
                .setSubjectAltNames(List.of(
                        new SubjectAltName(SubjectAltName.Type.DNS_NAME, "cv.gpl.ac.cn"),
                        new SubjectAltName(SubjectAltName.Type.IP_ADDRESS, "10.18.0.1"),
                        new SubjectAltName(SubjectAltName.Type.EMAIL, "gregPerlinLi@outlook.com"),
                        new SubjectAltName(SubjectAltName.Type.URI, "https://cv.gpl.ac.cn")
                ))
                .setExpiry(30)
                .setComment("This is a Test SSL Certificate.");

        GenResponse response = SslCertGenerator.generateSslCertificate(request);

        log.debug(response.toString());
        log.info("SSL Private Key: \n {}", new String(java.util.Base64.getDecoder().decode(response.getPrivkey())));
        log.info("SSL Certificate: \n {}", new String(java.util.Base64.getDecoder().decode(response.getCert())));
        log.info("SSL Certificate Start Date: {}", response.getNotBefore());
        log.info("SSL Certificate End Date: {}", response.getNotAfter());
    }

    @Test
    public void testRenewSslCertificate() {
        CertRenewRequest request = new CertRenewRequest()
                .setCaKey("LS0tLS1CRUdJTiBQUklWQVRFIEtFWS0tLS0tCk1JSUV2UUlCQURBTkJna3Foa2lHOXcwQkFRRUZBQVNDQktjd2dnU2pBZ0VBQW9JQkFRQzNkbTFWZWQzUzQzRWgKTzVvWnBkK1lqaCtFMG9qaTR3QUJDR2pBOFBsOU90WUVkalBwcWdJNnJjR0tvdmtKb2xOdUxmTUZobGZnTEc2TgoxZXlwcE1hUlFuWC9ReUh5azNrZGpCMXdPakFXWlFsZi9BMHdnY2MxanhEbmJnK2s1OTZ2emZuYWQvUkdmYmgzCllYWGQ4ZmJldWk4VEw5UUxtdGhRS0ZZZ1dLckY0SWRuZ2xJUWwrWk9KMkd2TmxYN3p3Z2YxdUlTbkp5K0RnU2kKa0NlRWxabm9aeGloeGhHZGlWSVU1cVJ5Z05IVlptSkc1VENkTXhpWURwVEpaM2pMVHp4bHlxNnpQNTVQMUVZNQprMkRkQ3VFblBYcDVmRWVUSkM2bm5kRFprLzI0MVNneVZ1MzUwUVdxdWc3YkIxN0Q5LzI0NTZocWhqZmVaK0JWCnBLbGtaclVQQWdNQkFBRUNnZ0VBR2NaMkt1Mmh1Q2pETXFlVWlXandCcGRsSHp5VEJjbGRyVWQ0ckM3TzVvUzMKSDg1Wmtja1VZaGthV1hkM0pKN2RPTndVeWlCclJUQUk0ajE5Y0FJWjhidVVKMlpQcFN5SjloaEM1SXNRU1gwdAplWUpJZWhtcG1zRThYejlyekQvVlhmN0N6U3BRTS8waXh3YjJ6OVZZV1Vkd0tMSnVDS2xiSGJ2bENjdGJSc3g5ClpFOC9JOFVvMW9QZGpCOTdBNnQ2WlJQbXhSdWVqYUhiQzNWRHNKTTcrTkhKcXVjTm40dUZ2aDFHRUR4ZjZhMzIKdDh4N013OUx0dEM3QkUzYWFTR3ZTMjd1Q29aeWl3VXU2cFBCRHJOTHRZaHZ1a0ZmRlRkR2k3dzc4Sk9mR1c3aQpWdnVOMThHZVd0dUU4NGY1V2dHb1cyNStOaTNLNWdFZzZzZEVER0szOFFLQmdRRFl2SjdnRFc5UmtxMWNxcFJTCjFVZ1gyNTh6Wm8wYmZQbWg0cjkxSndzZVI3a1ppaDJETFphZlhrUzA0ZlhDSUE1NFd3Vkx2dVdiaVJLQWxxdGoKUUNvUXl0ODVwbzBVNmd5WWtQelVuSGF3eFpyaVRWajlJM0ZCcXVBRVpOeVRHcHp4SVhrOThHV2FnblZlU1BBKwowK1pVS1E0VkhZSFMxOVlSSDcxL2h5VTQ4UUtCZ1FEWXNxNzN3cDVUVWViQnpidjJoZ2cxY0pqeFl0dHowWE9RCjJqOW41ZjBFanRtM3VzbnlsUjMrY2pVNEw5ZzV3bkUzdkdGOFhqbnk4U09sMkc3TWIxTkJyWU9WbUVIS3ZJeFYKYmxsYzJVUHphY3FZcDFVQi9ma1VsRHdGZFV4enFxSmY5K3BVUTFKQTNuUW56ZUkzMWRtZzIySE81SWdqbFFGNApXdklxSTFyTi93S0JnRTlDMDVzK2JvcFhhTHp0eU9adUJ6cHFYOU10V3NkRnNna280am1XdUxNdktac1VibXlOCm5IclZ2Nnlpd2Z4bk9zTjdEZm5BYXpteExDb0liODhSSlJFVkVBT0dUQ3ZzMkFSbmFYN2JaWENLSTNWRk1oa0oKQUI4eXZVLytEc2hoUUNuU3d3TUt5aTF5TGpmMzFwd3paQlU5R21CUWRTekZNQXo5SFpEb3ZJMFJBb0dBWnkwTQpxZUw4UjJlam0zczlsNjlSa1VBL1VnOWp0YzF3WFBQTlpNYllwYWJ1ZXRCdy94T0k2SEd3YlVRNmk2WE5DbUNqCmVmZlRWNTBCQUNJQS8wMnlNbjlQTzViM0hIU1J6TXR4dVFlcGx1ZzBFbUw1MHF6K1A1SWswZVI3dGtiMGNRVTEKaVZGVWhKWm1iOTFUYklwaHlIa3NKTG9qSiszMmVUdTBPZVFEaERrQ2dZRUFwaVZucnBidTNZd2I3WGpBa2hKUQowZE9JejUwaGp4eUh3Mk1xcHBJWjljaHV2WTh4eWRObGFXRU9CbzAxZEFQOVFTa0VUazVWMFQ1ZWc4QlpRb1FECmpieUNXOGkvQis5VXBIME5YakpXL0c5WEZJMHhOdWJTeHhtTUlDZmk1Y1drTm9mK3VGc0FZajZ0RU5RWWdZL3kKZjgwMEhmb0JmbEpNZzcrV0dOSWsyVW89Ci0tLS0tRU5EIFBSSVZBVEUgS0VZLS0tLS0K")
                .setCa("LS0tLS1CRUdJTiBDRVJUSUZJQ0FURS0tLS0tCk1JSUQ1ekNDQXMrZ0F3SUJBZ0lSQUxPV1BPQTg0TDN2dFhIR1A5N0JCODB3RFFZSktvWklodmNOQVFFTEJRQXcKZ1pveEN6QUpCZ05WQkFZVEFrTk9NUkl3RUFZRFZRUUlEQWxIZFdGdVoyUnZibWN4RHpBTkJnTlZCQWNNQmtOaApiblJ2YmpFVk1CTUdBMVVFQ2d3TVIzSmxaMUJsY214cGJreHBNUkl3RUFZRFZRUUxEQWxEWlhKMFZtRjFiSFF4CkVqQVFCZ05WQkFNTUNVTmxjblJXWVhWc2RERW5NQ1VHQ1NxR1NJYjNEUUVKQVJZWVozSmxaMUJsY214cGJreHAKUUc5MWRHeHZiMnN1WTI5dE1CNFhEVEkxTURNeE5UQTFORE16TTFvWERUSTJNRE14TlRBMU5ETXpNMW93Z1pveApDekFKQmdOVkJBWVRBa05PTVJJd0VBWURWUVFJREFsSGRXRnVaMlJ2Ym1jeER6QU5CZ05WQkFjTUJrTmhiblJ2CmJqRVZNQk1HQTFVRUNnd01SM0psWjFCbGNteHBia3hwTVJJd0VBWURWUVFMREFsRFpYSjBWbUYxYkhReEVqQVEKQmdOVkJBTU1DVU5sY25SV1lYVnNkREVuTUNVR0NTcUdTSWIzRFFFSkFSWVlaM0psWjFCbGNteHBia3hwUUc5MQpkR3h2YjJzdVkyOXRNSUlCSWpBTkJna3Foa2lHOXcwQkFRRUZBQU9DQVE4QU1JSUJDZ0tDQVFFQXQzWnRWWG5kCjB1TnhJVHVhR2FYZm1JNGZoTktJNHVNQUFRaG93UEQ1ZlRyV0JIWXo2YW9DT3EzQmlxTDVDYUpUYmkzekJZWlgKNEN4dWpkWHNxYVRHa1VKMS8wTWg4cE41SFl3ZGNEb3dGbVVKWC93Tk1JSEhOWThRNTI0UHBPZmVyODM1Mm5mMApSbjI0ZDJGMTNmSDIzcm92RXkvVUM1cllVQ2hXSUZpcXhlQ0haNEpTRUpmbVRpZGhyelpWKzg4SUg5YmlFcHljCnZnNEVvcEFuaEpXWjZHY1lvY1lSbllsU0ZPYWtjb0RSMVdaaVJ1VXduVE1ZbUE2VXlXZDR5MDg4WmNxdXN6K2UKVDlSR09aTmczUXJoSnoxNmVYeEhreVF1cDUzUTJaUDl1TlVvTWxidCtkRUZxcm9PMndkZXcvZjl1T2VvYW9ZMwozbWZnVmFTcFpHYTFEd0lEQVFBQm95WXdKREFPQmdOVkhROEJBZjhFQkFNQ0FZWXdFZ1lEVlIwVEFRSC9CQWd3CkJnRUIvd0lCQURBTkJna3Foa2lHOXcwQkFRc0ZBQU9DQVFFQUtaU0ZpVkd1dTF0TjFFL0NveEdpWGVVSnludmIKNDNUejBrd0ZhYkczZ0M1QlhVTzdwc2g1aWVVODNkYllXck9IcE5qNW8ycFd6a0dpekU2VE5zZ2g2NFUxSUllQwpUSW9ubFBab2U5T2UvaWs1UjIxRjFTVkhQK0l6dmVGd1FnNXNWZTM2dzlWcm52cnZNcDU0NzVObDcxLzB3dE0vCit0d3hPKzFKMG5hUEd6cEVXelZyMmNMRi9taEFzREpacWZuU08wTVhscUpWSjhhTVZUTStVYWNiSWlQM2hMUXIKa0VRd3g4UW9mMTNOMVY4Ti9leWpUcHlPVzZqREVRWElnK09Iam1BeFBnZ3I1RG9DQksvM3lzZFltWGhJN3p0TwpGQy9zMi9FT1RsQmNzQS83NmhZNkcwUG1ZdnI1ZUxrekc2WklmT25sSFpmVDY5eEJlT08wNDNwdTVBPT0KLS0tLS1FTkQgQ0VSVElGSUNBVEUtLS0tLQo=")
                .setUuid("e8e62fe9-b781-48df-832c-27f708fc6442")
                .setOldPrivkey("LS0tLS1CRUdJTiBQUklWQVRFIEtFWS0tLS0tCk1JSUV2d0lCQURBTkJna3Foa2lHOXcwQkFRRUZBQVNDQktrd2dnU2xBZ0VBQW9JQkFRQzBNc2NGcWpsR2NTenMKNFBTSVRuM0ZWLzhkemhEdkpOTjh0T2RPZFNOYnhnWFZTN2lSMVBsOXl5NHgwRWMzcmZjT1JVNlRPc1NadEJCRgphYXVQWGdSN2lDNTd5dXpSY3RmNWs2bTFLT3dSVlBnNUpZUkRtd1JrdmlBa2lVZWJlck16RkpCWFEzNjl1amE4CnBLYW15cTRZajBreTlaMWYwemxwMFIvMFJab0Z4MGdCWmRCa2tRekJQeXJDVXM1RmREWUNKcDdLaC8zSkt2bHIKMlFwVmpRVTBlQlozL2RZdHNTNVZZUXpMbFBmN3RmNVlNanRhbmwrUVNoSXh1QVJjaS85QTNJUFRhYjZPV2tvUwpTeWY2L09LczlMSGtVRFFiZ2VEeGVVVGNQTzF4bXpkbDdNZlRKaWFLTWdHZGo1QWZNRnRwamdxUHcyOEhxRDZSCnRHSXJVU21mQWdNQkFBRUNnZ0VBRFBsdytnUzk2c2N6aFM1VUZwakZ5YkJ2Wm5wNkhxa1VvbGJwV2RPMlQrNHkKTllZTWYxRWphNWVQME5ENEo3M2Fqa2d3Tm5EOEdEeWhlSHhmK0plSTRPTzI5MzF1bkV6VnBZR08rcW9pdXNPSwpJZERSTlFlNkF2VHJoSXhWY3hBY1M1SWprZ05QWW9rbWlTN1FpSk9rVHNTV1ZyK3F1ZEtwcHVlQ2VQdS84WThMCnlTLzhHdHVydGRMd0l0S3Z5SDBJNTZUeDU0eTZrd2JHcytrZUVobVc5dzFsMEw0cjZQN0k5bU1LT2dRaC9MRVMKdzN4TVJLU2hKRnJsY0ptbjNLeW03MHRJNG9mbjVsTHE4L3ZDYzQzMGJrV2NneGxxMmNPelQ0VGxOSDZuTk5ZbQpod28veVlZZWFhTncvdU1xTDEySzBkR2ZLaEVwU0s0ZXRueGlGb0hiWVFLQmdRRGs1U0RwRndFODhrR21vU1oxClRRbURDZ3ZSZHArVXAxaVFhMjBmNjgxVHJmU3RVYURZRGhTOG5ldko4TUxEcEt1QzQ2dDViNVp0TWRkd3VyV1QKREtlY0RjK1YyeHBNUGVUaTh1ZkFMSEp0MEo5cytYYmpCNFJGZS9saUNib1dNbjhmODd5SVp1cThyOEtVYUhIaQpYdGxUWE5CTWpBS2wrVGV0WkpVdWI3L1Ivd0tCZ1FESmlXMGRualFmTEtkMm9qenhaaGVWeFpEb0VhaWRPais3CmRIU0NuMGdZcUJwWG1qeGlXelViV3FIaUJGVHFCNGFOMlZMZUpLOWRVVFBtTGxLWXo3My9oUEFSaXRSd1ZSek0Kb09NL3ZhS3hGdzJzWkY5T1lKZVBaeS8va05CY25DTnNTcWY0Vjh6azhBZTNWM0xxZUFKbzNXKzVHRGN5N3N5eQoyRW16QTYxb1lRS0JnUUNNUnUvWWFjVFVlUk5LNzFBR2EyUDg3dGMzVTUrUkZzM3NGQ29ZZWdhbjFlQXhwK2tPCi8vSXRkZ3JmQTdJWS9INHdCUjg5bU9sem1pd1NaaHFKT0NRd096YVEvR290ZDNFaXRRTGFmMkxSY2gyQ1I1QlkKcW02aHRzeXJESk1DcjRmQktUck56V1RtcGtCMWUxendBbmpsNGVlMlFjZ050Nklybll6Zm5KVE9PUUtCZ1FDQwpvVGYvdlo2TklsVjllTlZGcHVYY3AwMHdqdG1hNTdtTm1JTTRjMk80ejZVYmFSYUFyaHV6R2tEWmpmTTRLaDZWCjdPcGdvS2ltTk04T0FMSjY2QlIvL2J2WnN3SFZ1ZVZMNFhES3pQRWFGaFkveW1OWUd4WEIxcUZ1NW4rWHQ0RGkKWFZXWWk5aDcvL1VRYW5kSzhQU200Zmpib1kyTnp1a1JkMDMxNFlsUm9RS0JnUUNaRkswUk1FdDd4OTJlWSswagpvY3l5ZG1qV1lJMWdNL0dkeTUyeWZlbUdiSG8vTTJxSEwraFBsUE9xN21HdXA3TFgvWUVIM3pzSXhzSlo0dnlUCm9TSmM5Z01PdGNiZExBWHIwWnNjRytzS0ZCaFBHZlhFNzZRekFLNXVOVXRHSk1oY2EzcS82ZEttTHZLVjBhaG8KQU83ekNlMTVuZVM1b2UxVGE5a29VZUl6SXc9PQotLS0tLUVORCBQUklWQVRFIEtFWS0tLS0tCg==")
                .setOldCert("LS0tLS1CRUdJTiBDRVJUSUZJQ0FURS0tLS0tCk1JSUVSVENDQXkyZ0F3SUJBZ0lSQVAwcXlMSFJ3OC9OQnNGeUJCUzNLYTh3RFFZSktvWklodmNOQVFFTEJRQXcKZ1pveEN6QUpCZ05WQkFZVEFrTk9NUkl3RUFZRFZRUUlEQWxIZFdGdVoyUnZibWN4RHpBTkJnTlZCQWNNQmtOaApiblJ2YmpFVk1CTUdBMVVFQ2d3TVIzSmxaMUJsY214cGJreHBNUkl3RUFZRFZRUUxEQWxEWlhKMFZtRjFiSFF4CkVqQVFCZ05WQkFNTUNVTmxjblJXWVhWc2RERW5NQ1VHQ1NxR1NJYjNEUUVKQVJZWVozSmxaMUJsY214cGJreHAKUUc5MWRHeHZiMnN1WTI5dE1CNFhEVEkxTURNeE5qQTVOVFkxT0ZvWERUSTFNRFF4TlRBNU5UWTFPRm93Z1oweApDekFKQmdOVkJBWVRBa05PTVJJd0VBWURWUVFJREFsSGRXRnVaMlJ2Ym1jeER6QU5CZ05WQkFjTUJrTmhiblJ2CmJqRVZNQk1HQTFVRUNnd01SM0psWjFCbGNteHBia3hwTVJJd0VBWURWUVFMREFsRFpYSjBWbUYxYkhReEZUQVQKQmdOVkJBTU1ER04yTG1kd2JDNWhZeTVqYmpFbk1DVUdDU3FHU0liM0RRRUpBUllZWjNKbFoxQmxjbXhwYmt4cApRRzkxZEd4dmIyc3VZMjl0TUlJQklqQU5CZ2txaGtpRzl3MEJBUUVGQUFPQ0FROEFNSUlCQ2dLQ0FRRUF0RExICkJhbzVSbkVzN09EMGlFNTl4VmYvSGM0UTd5VFRmTFRuVG5Valc4WUYxVXU0a2RUNWZjc3VNZEJITjYzM0RrVk8Ka3pyRW1iUVFSV21yajE0RWU0Z3VlOHJzMFhMWCtaT3B0U2pzRVZUNE9TV0VRNXNFWkw0Z0pJbEhtM3F6TXhTUQpWME4rdmJvMnZLU21wc3F1R0k5Sk12V2RYOU01YWRFZjlFV2FCY2RJQVdYUVpKRU13VDhxd2xMT1JYUTJBaWFlCnlvZjl5U3I1YTlrS1ZZMEZOSGdXZC8zV0xiRXVWV0VNeTVUMys3WCtXREk3V3A1ZmtFb1NNYmdFWEl2L1FOeUQKMDJtK2pscEtFa3NuK3Z6aXJQU3g1RkEwRzRIZzhYbEUzRHp0Y1pzM1plekgweVltaWpJQm5ZK1FIekJiYVk0SwpqOE52QjZnK2tiUmlLMUVwbndJREFRQUJvNEdBTUg0d1RRWURWUjBSQkVZd1JJSU1ZM1l1WjNCc0xtRmpMbU51Cmh3UUtFZ0FCZ1JobmNtVm5VR1Z5YkdsdVRHbEFiM1YwYkc5dmF5NWpiMjJHRkdoMGRIQnpPaTh2WTNZdVozQnMKTG1GakxtTnVNQTRHQTFVZER3RUIvd1FFQXdJRm9EQWRCZ05WSFNVRUZqQVVCZ2dyQmdFRkJRY0RBUVlJS3dZQgpCUVVIQXdJd0RRWUpLb1pJaHZjTkFRRUxCUUFEZ2dFQkFEM0xTcTdIM1VUUHY0OThBc1BPcHZqdnJnSjdiT0lyClBrR250aUFpNFJ4RVJkcXpkY3JLa3plNm5PLzVIdjE3RkFpZjMwWDhTcUVHV3lObFJ6cXl3bHJ2eWV4cHRHVjYKdjJBVmdOYWpnUzJ1ei9xT2gwZWtMekFYaG1Cb1psVkM2dEJMRmt6aisxL3dMTEVubkV2QXRsK0w2VjBvbTJMWgpHQ3ltMHVvYnBLVzgwa0dIME9vREV4SHAweTVVbk1aeFN3TjMyYTRTSTd6VUY0Mi9wdXB3aEtpTzBNWGJ0ejB5ClpJem0xemZOb1BJOWZyN1A3eHFQSnFpSlRYeDVTN0FSVWNnR3ZWRnJOeDZNYnRqakJZbXVldG9aR3IyLzQ1WFUKRTNPbHRBK2hwNTJiQm40M2FYVVFhanhtVGdsZVZjMFNCeUJhL2NYdkFNMGFRQStrVENIMlJtTT0KLS0tLS1FTkQgQ0VSVElGSUNBVEUtLS0tLQo=")
                .setNewExpiry(90)
                .setComment("Renewed SSL Certificate.");

        GenResponse response = SslCertGenerator.renewSslCertificate(request);

        log.debug(response.toString());
        log.info("New SSL Private Key: \n {}", new String(java.util.Base64.getDecoder().decode(response.getPrivkey())));
        log.info("New SSL Certificate: \n {}", new String(java.util.Base64.getDecoder().decode(response.getCert())));
        log.info("New SSL Certificate Start Date: {}", response.getNotBefore());
        log.info("New SSL Certificate End Date: {}", response.getNotAfter());
    }

}
